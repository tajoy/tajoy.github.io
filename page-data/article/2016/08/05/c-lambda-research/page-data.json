{"componentChunkName":"component---src-templates-article-js","path":"/article/2016/08/05/c-lambda-research/","result":{"data":{"site":{"siteMetadata":{"title":"Tajoy's Blog","author":{"name":"Tajoy"}}},"markdownRemark":{"id":"628f3132-8804-508b-b377-1d8c8855c2ec","html":"<h2 data-toc-id=\"f33df3a8-a0b2-49d2-af3f-6a649bd9fd71\">引子</h2>\n<p>最近在学习FP(函数式编程), 如 MapReduce, Rudex 等都是应用FP而来的.</p>\n<p>FP对于分布式, 测试等等都有着天生的优势. 而我现在所在的公司的各种代码大部分都是由C写的.\n而FP在实现上一般需要lambda的支持, 所以最近找了下C关于lambda方面的资料.</p>\n<!-- more -->\n<h2 data-toc-id=\"1c738b8d-dcbf-4df5-b31f-1eaaa1acb868\">C的lambda</h2>\n<p>网上找了以下, 第一搜索到这个:\n<a href=\"http://www.cnblogs.com/Joke-Shi/p/5489293.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Lambda表达式（C语言）</a></p>\n<p>下面是该文章中提到的代码:</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`#include <stdio.h>\n\n/** 这里是我们定义的Lambda表达式的宏定义 */\n#define cgs_lambda( return_type, function_body) \\\n       ({return_type cgs_lambda_func function_body cgs_lambda_func;})\n\n/*************************** 测试Main **************************/\n\nint main( int argc, const char **argv)\n{\n　　/* 我们做两个数相加的操作 */\n　　printf( &quot;Sum = %d\\n&quot;, cgs_lambda( int, (int x, int y){ return x + y; })(3, 4) );\n　　return 0;\n}`, ``)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container monokai grvsc-mm-tsSx3w grvsc-ps-tsSx3w grvsc-mm-tCN5OG grvsc-ps-tCN5OG\" data-language=\"c\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#include</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> </span><span class=\"grvsc-tsSx3w-6 grvsc-tCN5OG-12\">&lt;stdio.h&gt;</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-3 grvsc-tCN5OG-3\">/** 这里是我们定义的Lambda表达式的宏定义 */</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#define</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-4\">cgs_lambda</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">( </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-4\">return_type</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">, </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-4\">function_body</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">) </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-4\">\\</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">       ({return_type cgs_lambda_func function_body cgs_lambda_func;})</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-3 grvsc-tCN5OG-3\">/*************************** 测试Main **************************/</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-1\">main</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">( </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-1\">argc</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">const</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">char</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">**</span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-1\">argv</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">{</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">　　</span><span class=\"grvsc-tsSx3w-3 grvsc-tCN5OG-3\">/* 我们做两个数相加的操作 */</span></span>\n<span class=\"grvsc-line grvsc-line-highlighted\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">　　</span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-1\">printf</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">( </span><span class=\"grvsc-tsSx3w-6 grvsc-tCN5OG-12\">&quot;Sum = </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-12\">%d\\n</span><span class=\"grvsc-tsSx3w-6 grvsc-tCN5OG-12\">&quot;</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-1\">cgs_lambda</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">( </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, (</span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> x, </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> y){ </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">return</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> x </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">+</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> y; })(</span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">3</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">4</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">) );</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">　　</span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">return</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">0</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">}</span></span></code></pre>\n<p>然后我稍微优化了以下, 做了一些兼容.</p>\n<p>值得一提的是, 这个宏只支持<em>gcc的编译器</em>, 或者是支持<em>c++11的c++编译器</em>, 也就是C++的11版.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`#ifndef __LAMBDA__\n#define __LAMBDA__\n\n#ifdef __cplusplus\n    // 定义lambda宏  \n    #define lambda(return_type, func_parms, func_body)\\\n        ([&] -> return_type func_parms function_body)\n\n#else\n\n    #ifdef __GNUC__\n\n        // 定义lambda宏  \n        #define lambda(return_type, func_parms, func_body)\\\n        ({\\  \n                return_type \\$this func_parms func_body\\\n                \\$this;\\  \n        })\n\n    #else\n        #error &quot;not support!&quot;\n    #endif //__GNUC__\n\n#endif //__cplusplus\n\n#define \\$ lambda\n\n#endif // __LAMBDA__`, ``)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container monokai grvsc-mm-tsSx3w grvsc-ps-tsSx3w grvsc-mm-tCN5OG grvsc-ps-tCN5OG\" data-language=\"c++\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#ifndef</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> __LAMBDA__</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#define</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-4\">__LAMBDA__</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#ifdef</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> __cplusplus</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-3 grvsc-tCN5OG-3\">    // 定义lambda宏  </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">    </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#define</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-4\">lambda</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">(</span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-4\">return_type</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">, </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-4\">func_parms</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">, </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-4\">func_body</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">)</span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-4\">\\</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">        ([&] -&gt; return_type func_parms function_body)</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#else</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#ifdef</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> __GNUC__</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-3 grvsc-tCN5OG-3\">        // 定义lambda宏  </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">        </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#define</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-4\">lambda</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">(</span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-4\">return_type</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">, </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-4\">func_parms</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">, </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-4\">func_body</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">)</span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-4\">\\</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">        ({\\  </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">                return_type $this func_parms func_body\\</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">                $this;\\  </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">        })</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">    #else</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\">        </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#error</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> </span><span class=\"grvsc-tsSx3w-6 grvsc-tCN5OG-12\">&quot;not support!&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">    #endif</span><span class=\"grvsc-tsSx3w-3 grvsc-tCN5OG-3\"> //__GNUC__</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#endif</span><span class=\"grvsc-tsSx3w-3 grvsc-tCN5OG-3\"> //__cplusplus</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">#define $ lambda</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#endif</span><span class=\"grvsc-tsSx3w-3 grvsc-tCN5OG-3\"> // __LAMBDA__</span></span></code></pre>\n<p>下面是使用示例:</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`#include <stdio.h>\n\n#include &quot;lambda.h&quot;\n\ntypedef int (*Adder)(int, int);\n\nint sum(int *arr, int length, Adder adder)\n{\n    int i = 0, sum = 0;\n    for (i = 0; i < length; i++)\n    {\n        sum = adder(sum, arr[i]);\n    }\n    return sum;\n}\n\nint main(int argc, char const *argv[])\n{\n    int arr[] = { 1, 2, 3, 4, 5 };\n\n    Adder adder = \\$(int, (int _a, int _b), {\n        int c = _a + _b;\n        return c;\n    });\n\n    int ret = sum(arr, sizeof(arr) / sizeof(int), adder);\n    printf(&quot;sum of arr is %d\\n&quot;, ret);\n    return 0;\n}`, ``)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container monokai grvsc-mm-tsSx3w grvsc-ps-tsSx3w grvsc-mm-tCN5OG grvsc-ps-tCN5OG\" data-language=\"c\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#include</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> </span><span class=\"grvsc-tsSx3w-6 grvsc-tCN5OG-12\">&lt;stdio.h&gt;</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">#include</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-4\"> </span><span class=\"grvsc-tsSx3w-6 grvsc-tCN5OG-12\">&quot;lambda.h&quot;</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">typedef</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> (</span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">*</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">Adder)(</span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">);</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-1\">sum</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">(</span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">*</span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-1\">arr</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-1\">length</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, Adder </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-1\">adder</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">{</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> i </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">=</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">0</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, sum </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">=</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">0</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">for</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> (i </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">=</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">0</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">; i </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">&lt;</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> length; i</span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">++</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">        sum </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">=</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-1\">adder</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">(sum, arr[i]);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">return</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> sum;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">}</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-1\">main</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">(</span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-1\">argc</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">char</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">const</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">*</span><span class=\"grvsc-tsSx3w-10 grvsc-tsSx3w-i grvsc-tCN5OG-1\">argv</span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">[]</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">{</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> arr</span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">[]</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">=</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> { </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">1</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">2</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">3</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">4</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">5</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> };</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    Adder adder </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">=</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> $(</span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, (</span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> _a, </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> _b), {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">        </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> c </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">=</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> _a </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">+</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> _b;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">        </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">return</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> c;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    });</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    </span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> ret </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">=</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-1\">sum</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">(arr, </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">sizeof</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">(arr) </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-1\">/</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">sizeof</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">(</span><span class=\"grvsc-tsSx3w-9 grvsc-tsSx3w-i grvsc-tCN5OG-4\">int</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">), adder);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    </span><span class=\"grvsc-tsSx3w-5 grvsc-tCN5OG-1\">printf</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">(</span><span class=\"grvsc-tsSx3w-6 grvsc-tCN5OG-12\">&quot;sum of arr is </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-12\">%d\\n</span><span class=\"grvsc-tsSx3w-6 grvsc-tCN5OG-12\">&quot;</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">, ret);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">    </span><span class=\"grvsc-tsSx3w-7 grvsc-tCN5OG-4\">return</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\"> </span><span class=\"grvsc-tsSx3w-4 grvsc-tCN5OG-5\">0</span><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-tsSx3w-1 grvsc-tCN5OG-1\">}</span></span></code></pre>\n<p>打印输出结果:</p>\n<blockquote>\n<p>sum of arr is 15</p>\n</blockquote>\n<h2 data-toc-id=\"70ef7d20-68f9-4735-87bc-3fd8721adac5\">局限与注意事项</h2>\n<p>在lambda函数被其他地方调用的时候, 可以在lambda函数内捕获那些外部的变量</p>\n<p>但是, 如果被捕获的外部变量如果超出作用域, 那将造成<strong>程序崩溃</strong></p>\n<p>所以, 更推荐只引用外部的静态/全局变量, 或者配合静态/全局变量 malloc/new 一个内存出来访问</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n  }\n  \n  .grvsc-code {\n    display: inline-block;\n    min-width: 100%;\n  }\n  \n  .grvsc-line {\n    display: inline-block;\n    box-sizing: border-box;\n    width: 100%;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-line-highlighted {\n    background-color: var(--grvsc-line-highlighted-background-color, transparent);\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, transparent);\n  }\n  \n  .monokai {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  .monokai .grvsc-tsSx3w-i { font-style: italic; }\n  .monokai .grvsc-tsSx3w-7 { color: #F92672; }\n  .monokai .grvsc-tsSx3w-1 { color: #F8F8F2; }\n  .monokai .grvsc-tsSx3w-6 { color: #E6DB74; }\n  .monokai .grvsc-tsSx3w-3 { color: #75715E; }\n  .monokai .grvsc-tsSx3w-5 { color: #A6E22E; }\n  .monokai .grvsc-tsSx3w-10 { color: #FD971F; }\n  .monokai .grvsc-tsSx3w-4 { color: #AE81FF; }\n  .monokai .grvsc-tsSx3w-9 { color: #66D9EF; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-i { font-style: italic; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-7 { color: #F92672; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-1 { color: #F8F8F2; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-6 { color: #E6DB74; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-3 { color: #75715E; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-5 { color: #A6E22E; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-10 { color: #FD971F; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-4 { color: #AE81FF; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-9 { color: #66D9EF; }\n  \n  /* Monokai */\n  @media (prefers-color-scheme: dark) {\n    .grvsc-mm-tsSx3w {\n      background-color: #272822;\n      color: #f8f8f2;\n    }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-i { font-style: italic; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-7 { color: #F92672; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-1 { color: #F8F8F2; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-6 { color: #E6DB74; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-3 { color: #75715E; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-5 { color: #A6E22E; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-10 { color: #FD971F; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-4 { color: #AE81FF; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-9 { color: #66D9EF; }\n  }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG {\n    background-color: #FFFFFF;\n    color: #000000;\n  }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-4 { color: #0000FF; }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-12 { color: #A31515; }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-3 { color: #008000; }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-1 { color: #000000; }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-5 { color: #09885A; }\n  \n  /* Visual Studio Light */\n  @media (prefers-color-scheme: light) {\n    .grvsc-mm-tCN5OG {\n      background-color: #FFFFFF;\n      color: #000000;\n    }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-4 { color: #0000FF; }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-12 { color: #A31515; }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-3 { color: #008000; }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-1 { color: #000000; }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-5 { color: #09885A; }\n  }\n</style>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{"dataTocId":"f33df3a8-a0b2-49d2-af3f-6a649bd9fd71"},"children":[{"type":"text","value":"引子"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"最近在学习FP(函数式编程), 如 MapReduce, Rudex 等都是应用FP而来的."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"FP对于分布式, 测试等等都有着天生的优势. 而我现在所在的公司的各种代码大部分都是由C写的.\n而FP在实现上一般需要lambda的支持, 所以最近找了下C关于lambda方面的资料."}]},{"type":"text","value":"\n"},{"type":"comment","value":" more "},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"dataTocId":"1c738b8d-dcbf-4df5-b31f-1eaaa1acb868"},"children":[{"type":"text","value":"C的lambda"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"网上找了以下, 第一搜索到这个:\n"},{"type":"element","tagName":"a","properties":{"href":"http://www.cnblogs.com/Joke-Shi/p/5489293.html","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"Lambda表达式（C语言）"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"下面是该文章中提到的代码:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-code-button-container"],"dataToasterId":"","dataToasterClass":"gatsby-code-button-toaster","dataToasterTextClass":"gatsby-code-button-toaster-text","dataToasterText":"","dataToasterDuration":"3500","onclick":"copyToClipboard(`#include <stdio.h>\n\n/** 这里是我们定义的Lambda表达式的宏定义 */\n#define cgs_lambda( return_type, function_body) \\\n       ({return_type cgs_lambda_func function_body cgs_lambda_func;})\n\n/*************************** 测试Main **************************/\n\nint main( int argc, const char **argv)\n{\n　　/* 我们做两个数相加的操作 */\n　　printf( \"Sum = %d\\n\", cgs_lambda( int, (int x, int y){ return x + y; })(3, 4) );\n　　return 0;\n}`, ``)"},"children":[{"type":"text","value":"\n              "},{"type":"element","tagName":"div","properties":{"className":["gatsby-code-button"],"dataTooltip":""},"children":[{"type":"text","value":"\n                "},{"type":"element","tagName":"svg","properties":{"className":["gatsby-code-button-icon"],"xmlns":"http://www.w3.org/2000/svg","width":"24","height":"24","viewBox":"0 0 24 24"},"children":[{"type":"element","tagName":"path","properties":{"fill":"none","d":"M0 0h24v24H0V0z"},"children":[]},{"type":"element","tagName":"path","properties":{"d":"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"},"children":[]}]},{"type":"text","value":"\n              "}]},{"type":"text","value":"\n            "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","monokai","grvsc-mm-tsSx3w","grvsc-ps-tsSx3w","grvsc-mm-tCN5OG","grvsc-ps-tCN5OG"],"dataLanguage":"c","dataIndex":"0"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#include"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-6","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"<stdio.h>"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-3","grvsc-tCN5OG-3"]},"children":[{"type":"text","value":"/** 这里是我们定义的Lambda表达式的宏定义 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#define"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"cgs_lambda"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"( "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"return_type"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"function_body"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":") "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"\\"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"       ({return_type cgs_lambda_func function_body cgs_lambda_func;})"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-3","grvsc-tCN5OG-3"]},"children":[{"type":"text","value":"/*************************** 测试Main **************************/"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"main"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"( "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"argc"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"char"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"**"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"argv"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"{"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"　　"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-3","grvsc-tCN5OG-3"]},"children":[{"type":"text","value":"/* 我们做两个数相加的操作 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line","grvsc-line-highlighted"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"　　"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"printf"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"( "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-6","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"\"Sum = "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"%d\\n"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-6","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"cgs_lambda"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"( "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", ("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" x, "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" y){ "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" x "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" y; })("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"4"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":") );"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"　　"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":";"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"然后我稍微优化了以下, 做了一些兼容."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"值得一提的是, 这个宏只支持"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"gcc的编译器"}]},{"type":"text","value":", 或者是支持"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"c++11的c++编译器"}]},{"type":"text","value":", 也就是C++的11版."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-code-button-container"],"dataToasterId":"","dataToasterClass":"gatsby-code-button-toaster","dataToasterTextClass":"gatsby-code-button-toaster-text","dataToasterText":"","dataToasterDuration":"3500","onclick":"copyToClipboard(`#ifndef __LAMBDA__\n#define __LAMBDA__\n\n#ifdef __cplusplus\n    // 定义lambda宏  \n    #define lambda(return_type, func_parms, func_body)\\\n        ([&] -> return_type func_parms function_body)\n\n#else\n\n    #ifdef __GNUC__\n\n        // 定义lambda宏  \n        #define lambda(return_type, func_parms, func_body)\\\n        ({\\  \n                return_type \\$this func_parms func_body\\\n                \\$this;\\  \n        })\n\n    #else\n        #error \"not support!\"\n    #endif //__GNUC__\n\n#endif //__cplusplus\n\n#define \\$ lambda\n\n#endif // __LAMBDA__`, ``)"},"children":[{"type":"text","value":"\n              "},{"type":"element","tagName":"div","properties":{"className":["gatsby-code-button"],"dataTooltip":""},"children":[{"type":"text","value":"\n                "},{"type":"element","tagName":"svg","properties":{"className":["gatsby-code-button-icon"],"xmlns":"http://www.w3.org/2000/svg","width":"24","height":"24","viewBox":"0 0 24 24"},"children":[{"type":"element","tagName":"path","properties":{"fill":"none","d":"M0 0h24v24H0V0z"},"children":[]},{"type":"element","tagName":"path","properties":{"d":"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"},"children":[]}]},{"type":"text","value":"\n              "}]},{"type":"text","value":"\n            "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","monokai","grvsc-mm-tsSx3w","grvsc-ps-tsSx3w","grvsc-mm-tCN5OG","grvsc-ps-tCN5OG"],"dataLanguage":"c++","dataIndex":"1"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#ifndef"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" __LAMBDA__"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#define"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"__LAMBDA__"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#ifdef"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" __cplusplus"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-3","grvsc-tCN5OG-3"]},"children":[{"type":"text","value":"    // 定义lambda宏  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#define"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"lambda"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"return_type"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"func_parms"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"func_body"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"\\"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"        ([&] -> return_type func_parms function_body)"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#else"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#ifdef"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" __GNUC__"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-3","grvsc-tCN5OG-3"]},"children":[{"type":"text","value":"        // 定义lambda宏  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"        "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#define"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"lambda"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"return_type"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"func_parms"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"func_body"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"\\"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"        ({\\  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"                return_type $this func_parms func_body\\"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"                $this;\\  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"        })"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"    #else"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"        "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#error"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-6","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"\"not support!\""}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"    #endif"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-3","grvsc-tCN5OG-3"]},"children":[{"type":"text","value":" //__GNUC__"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#endif"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-3","grvsc-tCN5OG-3"]},"children":[{"type":"text","value":" //__cplusplus"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"#define $ lambda"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#endif"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-3","grvsc-tCN5OG-3"]},"children":[{"type":"text","value":" // __LAMBDA__"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"下面是使用示例:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-code-button-container"],"dataToasterId":"","dataToasterClass":"gatsby-code-button-toaster","dataToasterTextClass":"gatsby-code-button-toaster-text","dataToasterText":"","dataToasterDuration":"3500","onclick":"copyToClipboard(`#include <stdio.h>\n\n#include \"lambda.h\"\n\ntypedef int (*Adder)(int, int);\n\nint sum(int *arr, int length, Adder adder)\n{\n    int i = 0, sum = 0;\n    for (i = 0; i < length; i++)\n    {\n        sum = adder(sum, arr[i]);\n    }\n    return sum;\n}\n\nint main(int argc, char const *argv[])\n{\n    int arr[] = { 1, 2, 3, 4, 5 };\n\n    Adder adder = \\$(int, (int _a, int _b), {\n        int c = _a + _b;\n        return c;\n    });\n\n    int ret = sum(arr, sizeof(arr) / sizeof(int), adder);\n    printf(\"sum of arr is %d\\n\", ret);\n    return 0;\n}`, ``)"},"children":[{"type":"text","value":"\n              "},{"type":"element","tagName":"div","properties":{"className":["gatsby-code-button"],"dataTooltip":""},"children":[{"type":"text","value":"\n                "},{"type":"element","tagName":"svg","properties":{"className":["gatsby-code-button-icon"],"xmlns":"http://www.w3.org/2000/svg","width":"24","height":"24","viewBox":"0 0 24 24"},"children":[{"type":"element","tagName":"path","properties":{"fill":"none","d":"M0 0h24v24H0V0z"},"children":[]},{"type":"element","tagName":"path","properties":{"d":"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"},"children":[]}]},{"type":"text","value":"\n              "}]},{"type":"text","value":"\n            "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","monokai","grvsc-mm-tsSx3w","grvsc-ps-tsSx3w","grvsc-mm-tCN5OG","grvsc-ps-tCN5OG"],"dataLanguage":"c","dataIndex":"2"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#include"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-6","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"<stdio.h>"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"#include"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-6","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"\"lambda.h\""}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"typedef"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" ("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"*"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"Adder)("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":");"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"sum"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"*"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"arr"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"length"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", Adder "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"adder"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"{"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" i "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", sum "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":";"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" (i "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"; i "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" length; i"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"++"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    {"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"        sum "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"adder"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"(sum, arr[i]);"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    }"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" sum;"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"}"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"main"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"argc"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"char"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"*"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-10","grvsc-tsSx3w-i","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"argv"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"[]"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"{"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" arr"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"[]"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" { "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"4"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"5"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" };"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    Adder adder "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" $("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", ("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" _a, "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" _b), {"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"        "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" c "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" _a "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" _b;"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"        "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" c;"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    });"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" ret "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"sum"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"(arr, "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"sizeof"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"(arr) "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"/"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"sizeof"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-9","grvsc-tsSx3w-i","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"), adder);"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-5","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"printf"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-6","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"\"sum of arr is "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"%d\\n"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-6","grvsc-tCN5OG-12"]},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":", ret);"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-7","grvsc-tCN5OG-4"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-4","grvsc-tCN5OG-5"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":";"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-tsSx3w-1","grvsc-tCN5OG-1"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"打印输出结果:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"sum of arr is 15"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"dataTocId":"70ef7d20-68f9-4735-87bc-3fd8721adac5"},"children":[{"type":"text","value":"局限与注意事项"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在lambda函数被其他地方调用的时候, 可以在lambda函数内捕获那些外部的变量"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"但是, 如果被捕获的外部变量如果超出作用域, 那将造成"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"程序崩溃"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"所以, 更推荐只引用外部的静态/全局变量, 或者配合静态/全局变量 malloc/new 一个内存出来访问"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"style","properties":{"className":["grvsc-styles"]},"children":[{"type":"text","value":"\n  .grvsc-container {\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n  }\n  \n  .grvsc-code {\n    display: inline-block;\n    min-width: 100%;\n  }\n  \n  .grvsc-line {\n    display: inline-block;\n    box-sizing: border-box;\n    width: 100%;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-line-highlighted {\n    background-color: var(--grvsc-line-highlighted-background-color, transparent);\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, transparent);\n  }\n  \n  .monokai {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  .monokai .grvsc-tsSx3w-i { font-style: italic; }\n  .monokai .grvsc-tsSx3w-7 { color: #F92672; }\n  .monokai .grvsc-tsSx3w-1 { color: #F8F8F2; }\n  .monokai .grvsc-tsSx3w-6 { color: #E6DB74; }\n  .monokai .grvsc-tsSx3w-3 { color: #75715E; }\n  .monokai .grvsc-tsSx3w-5 { color: #A6E22E; }\n  .monokai .grvsc-tsSx3w-10 { color: #FD971F; }\n  .monokai .grvsc-tsSx3w-4 { color: #AE81FF; }\n  .monokai .grvsc-tsSx3w-9 { color: #66D9EF; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-i { font-style: italic; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-7 { color: #F92672; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-1 { color: #F8F8F2; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-6 { color: #E6DB74; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-3 { color: #75715E; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-5 { color: #A6E22E; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-10 { color: #FD971F; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-4 { color: #AE81FF; }\n  div.layout[data-theme=dark] .grvsc-ps-tsSx3w .grvsc-tsSx3w-9 { color: #66D9EF; }\n  \n  /* Monokai */\n  @media (prefers-color-scheme: dark) {\n    .grvsc-mm-tsSx3w {\n      background-color: #272822;\n      color: #f8f8f2;\n    }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-i { font-style: italic; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-7 { color: #F92672; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-1 { color: #F8F8F2; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-6 { color: #E6DB74; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-3 { color: #75715E; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-5 { color: #A6E22E; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-10 { color: #FD971F; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-4 { color: #AE81FF; }\n    .grvsc-mm-tsSx3w .grvsc-tsSx3w-9 { color: #66D9EF; }\n  }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG {\n    background-color: #FFFFFF;\n    color: #000000;\n  }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-4 { color: #0000FF; }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-12 { color: #A31515; }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-3 { color: #008000; }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-1 { color: #000000; }\n  div.layout[data-theme=light] .grvsc-ps-tCN5OG .grvsc-tCN5OG-5 { color: #09885A; }\n  \n  /* Visual Studio Light */\n  @media (prefers-color-scheme: light) {\n    .grvsc-mm-tCN5OG {\n      background-color: #FFFFFF;\n      color: #000000;\n    }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-4 { color: #0000FF; }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-12 { color: #A31515; }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-3 { color: #008000; }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-1 { color: #000000; }\n    .grvsc-mm-tCN5OG .grvsc-tCN5OG-5 { color: #09885A; }\n  }\n"}]}],"data":{"quirksMode":false}},"timeToRead":2,"cnWordCount":363,"excerpt":"引子 最近在学习FP(函数式编程), 如 MapReduce, Rudex 等都是应用FP而来的. FP对于分布式, 测试等等都有着天生的优势. 而我现在所在的公司的各种代码大部分都是由C写的.\n而FP在实现上一般需要lambda的支持, 所以最近找了下C关于lambda方面的资料.","frontmatter":{"tocMaxDepth":null},"fields":{"title":"C语言的lambda的探究 - C语言的一些小技巧(1)","slug":"c-lambda-research","url":"/article/2016/08/05/c-lambda-research/","date":"2016-08-05","description":"C语言的一些小技巧 C语言环境下的lambda的探究","keywords":["c语言","函数式编程","lambda","c语言函数","c语言指针","c语言static","c语言吧","c语言从入门到放弃","FP","编译器","全局变量","函数","静态","代码","打印输出","作用域","示例"],"draft":false,"showComments":true,"category":{"name":"技术磨练","slug":"ji155-shu63-mo63-lian86"},"series":{"name":"C语言的一些小技巧","slug":"c-yu271-yan210-di93-yi99-xie53-xiao34-ji155-qiao31"},"tags":[{"name":"C","slug":"c"},{"name":"函数式编程","slug":"han50-shu56-shi78-bian50-cheng77"},{"name":"lambda","slug":"lambda"}]}}},"pageContext":{"slug":"c-lambda-research","previous":{"id":"4de27fe5-5a92-5d89-a793-1304f2b778b7","fields":{"slug":"first-post","url":"/article/2016/08/01/first-post/","title":"No.1"}},"next":{"id":"4aa8b4b0-2630-5d00-9f22-7a0ec0e3320e","fields":{"slug":"painting-bookmark-site","url":"/article/2016/08/05/painting-bookmark-site/","title":"关于画画的一些网络收藏"}}}}}