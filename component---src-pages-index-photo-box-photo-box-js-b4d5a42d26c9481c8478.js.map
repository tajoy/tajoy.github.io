{"version":3,"sources":["webpack:///./node_modules/gatsby/node_modules/core-js/modules/es6.string.fixed.js","webpack:///./src/components/Marquee.js","webpack:///./src/pages/index/photo-box/PhotoBox.js"],"names":["createHTML","this","Container","styled","div","rhythm","props","width","height","bottom","duration","delay","ItemWrapper","shouldAnimate","top","opacity","Marquee","state","currentIndex","componentDidMount","items","length","triggerMoveTimer","interval","self","moveTimer","clearTimeout","setTimeout","moveIt","triggerNextTimer","nextTimer","next","setState","direction","isUp","componentWillUnmount","render","Math","max","curItem","nextItem","prevItem","Component","defaultProps","PhotoAlbum","StyledMarquee","Picture","img","RANDOM_CACHE","PhotoBox","pictures","count","copyItems","i","i1","parseInt","random","i2","temp","slice","randomPickup","allFile","edges","map","node","splitted","index","picture","push","convert","childImageSharp","fixed","key","src","onClick","navigate","fields","url"],"mappings":"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","file":"component---src-pages-index-photo-box-photo-box-js-b4d5a42d26c9481c8478.js","sourcesContent":["'use strict';\n// B.2.3.6 String.prototype.fixed()\nrequire('./_string-html')('fixed', function (createHTML) {\n  return function fixed() {\n    return createHTML(this, 'tt', '', '');\n  };\n});\n","import React, { Component } from \"react\"\nimport PropTypes from \"prop-types\"\n\nimport styled from \"styled-components\"\n\nimport _, { isNull } from \"lodash\"\nimport { rhythm } from \"../utils/typography\"\n\nconst Container = styled.div`\n  margin-top: ${rhythm(0.5)};\n  position: relative;\n  overflow: hidden;\n  width: ${props => `${props.width}px`};\n  height: ${props => `${props.height}px`};\n  margin-bottom: ${props => `${props.bottom}px`};\n  transition: ${props => `all ${props.duration}ms ease-in ${props.delay}ms`};\n`\n\nconst ItemWrapper = styled.div`\n  margin: 0;\n  padding: 0;\n  width: ${props => `${props.width}px`};\n  height: ${props => `${props.height}px`};\n\n  transition: ${props =>\n    props.shouldAnimate\n      ? `all ${props.duration}ms ease-in ${props.delay}ms`\n      : `none`};\n\n  position: absolute;\n  top: ${props => `${props.top || 0}px`};\n  left: 0;\n  opacity: ${props => `${props.opacity}`};\n  * {\n    margin: 0;\n    padding: 0;\n  }\n`\n\nclass Marquee extends Component {\n  static propTypes = {\n    interval: PropTypes.number,\n    direction: PropTypes.oneOf([\"up\", \"down\"]),\n    duration: PropTypes.number,\n    delay: PropTypes.number,\n    items: PropTypes.arrayOf(PropTypes.object),\n  }\n  static defaultProps = {\n    /* 移动方向, 默认向上 */\n    direction: \"up\",\n    /* 移动间隔 */\n    interval: 2000,\n    /* 动画时长 */\n    duration: 300,\n    /* 动画延迟 */\n    delay: 0,\n\n    items: [],\n  }\n  constructor() {\n    super()\n    this.state = {\n      /* 当前元素 */\n      currentIndex: 0,\n      shouldAnimate: false,\n    }\n  }\n\n  get prevItem() {\n    const { items } = this.props\n    const currentIndex = this.state.currentIndex || 0\n    return items[currentIndex - 1 < 0 ? items.length - 1 : currentIndex - 1]\n  }\n\n  get curItem() {\n    const { items } = this.props\n    const currentIndex = this.state.currentIndex || 0\n    return items[currentIndex]\n  }\n\n  get nextItem() {\n    const { items } = this.props\n    const currentIndex = this.state.currentIndex || 0\n    return items[(currentIndex + 1) % items.length]\n  }\n\n  componentDidMount() {\n    if (this.props.items && this.props.items.length > 1) {\n      this.triggerMoveTimer()\n    }\n  }\n\n  triggerMoveTimer() {\n    const { interval } = this.props\n    const self = this\n    if (this.moveTimer) {\n      clearTimeout(this.moveTimer)\n    }\n    this.moveTimer = setTimeout(() => {\n      self.moveIt()\n    }, interval)\n  }\n\n  triggerNextTimer() {\n    const { duration, delay } = this.props\n    const self = this\n    if (this.nextTimer) {\n      clearTimeout(this.nextTimer)\n    }\n    this.nextTimer = setTimeout(() => {\n      self.next()\n    }, duration + delay)\n  }\n\n  moveIt() {\n    // console.log(\"move it\")\n    this.setState({\n      shouldAnimate: true,\n    })\n    this.triggerNextTimer()\n  }\n\n  next() {\n    const { duration, direction, items } = this.props\n    const currentIndex = this.state.currentIndex || 0\n    const isUp = direction === \"up\"\n    // console.log(\"next\")\n    this.setState({\n      shouldAnimate: false,\n      currentIndex: isUp\n        ? (currentIndex + 1) % items.length\n        : currentIndex - 1 < 0\n        ? items.length - 1\n        : currentIndex - 1,\n    })\n    this.triggerMoveTimer()\n  }\n\n  componentWillUnmount() {\n    if (this.moveTimer) {\n      clearTimeout(this.moveTimer)\n    }\n    if (this.nextTimer) {\n      clearTimeout(this.nextTimer)\n    }\n  }\n\n  render() {\n    const { direction, interval, duration, delay } = this.props\n    const { currentIndex, shouldAnimate } = this.state\n    const isUp = direction === \"up\"\n    const width = isUp\n      ? Math.max(this.curItem.width, this.nextItem.width)\n      : Math.max(this.curItem.width, this.prevItem.width)\n    const height = isUp\n      ? Math.max(this.curItem.height, this.nextItem.height)\n      : Math.max(this.curItem.height, this.prevItem.height)\n    return (\n      <Container\n        duration={duration}\n        delay={delay}\n        width={width}\n        height={height}\n        bottom={this.curItem.height - height}\n      >\n        <ItemWrapper\n          shouldAnimate={shouldAnimate}\n          duration={duration}\n          delay={delay}\n          top={\n            shouldAnimate\n              ? isUp\n                ? -this.curItem.height\n                : 0\n              : -this.curItem.height\n          }\n          opacity={shouldAnimate ? (isUp ? 0 : 1) : 0}\n        >\n          {this.prevItem.Component()}\n        </ItemWrapper>\n        <ItemWrapper\n          shouldAnimate={shouldAnimate}\n          duration={duration}\n          delay={delay}\n          top={\n            shouldAnimate\n              ? isUp\n                ? -this.curItem.height\n                : this.curItem.height\n              : 0\n          }\n          opacity={shouldAnimate ? 0 : 1}\n        >\n          {this.curItem.Component()}\n        </ItemWrapper>\n        <ItemWrapper\n          shouldAnimate={shouldAnimate}\n          duration={duration}\n          delay={delay}\n          top={\n            shouldAnimate\n              ? isUp\n                ? 0\n                : this.curItem.height\n              : this.curItem.height\n          }\n          opacity={shouldAnimate ? (isUp ? 1 : 0) : 0}\n        >\n          {this.nextItem.Component()}\n        </ItemWrapper>\n      </Container>\n    )\n  }\n}\n\nexport default Marquee\n","import React from \"react\"\nimport { Link, useStaticQuery, graphql, navigate } from \"gatsby\"\n\nimport styled from \"styled-components\"\n\nimport { rhythm } from \"../../../utils/typography\"\n\nimport Marquee from \"../../../components/Marquee\"\n\nconst Container = styled.div`\n  h2 {\n    margin-top: ${rhythm(2)};\n  }\n`\n\nconst PhotoAlbum = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-evenly;\n  flex-wrap: wrap;\n`\nconst StyledMarquee = styled(Marquee)``\n\nconst Picture = styled.img`\n  width: ${props => `${props.width}px`};\n  height: ${props => `${props.height}px`};\n  cursor: pointer;\n`\n\nlet RANDOM_CACHE = null\n\nconst randomPickup = (items, count) => {\n  if (RANDOM_CACHE) return RANDOM_CACHE\n  const copyItems = [...items]\n  for (let i = 0; i < copyItems.length * 3; i++) {\n    const i1 = parseInt(`${Math.random() * copyItems.length}`)\n    const i2 = parseInt(`${Math.random() * copyItems.length}`)\n    const temp = copyItems[i1]\n    copyItems[i1] = copyItems[i2]\n    copyItems[i2] = temp\n  }\n  RANDOM_CACHE = copyItems.slice(0, count)\n  return RANDOM_CACHE\n}\n\nconst PhotoBox = () => {\n  const allPictures = useStaticQuery(graphql`\n    query PhotoBox {\n      allFile(\n        filter: { sourceInstanceName: { eq: \"photos\" } }\n        sort: { fields: fields___date, order: DESC }\n      ) {\n        edges {\n          node {\n            fields {\n              url\n              date\n            }\n            childImageSharp {\n              fixed(\n                width: 320\n                height: 320\n                quality: 90\n                background: \"rgba(0,0,0,0)\"\n                toFormat: PNG\n                fit: CONTAIN\n              ) {\n                src\n                width\n                height\n              }\n            }\n          }\n        }\n      }\n    }\n  `).allFile.edges.map(({ node }) => node)\n  const pictures = randomPickup(allPictures, 20)\n  const splitted = [[], [], [], []]\n  let index = 0\n  for (let i = 0; i < pictures.length; i++) {\n    const picture = pictures[i]\n    splitted[index].push(picture)\n    index = (index + 1) % 4\n  }\n\n  const convert = pictures => {\n    return pictures.map((picture, i) => {\n      return {\n        width: picture.childImageSharp.fixed.width,\n        height: picture.childImageSharp.fixed.height,\n        Component: () => (\n          <Picture\n            key={i}\n            width={picture.childImageSharp.fixed.width}\n            height={picture.childImageSharp.fixed.height}\n            src={picture.childImageSharp.fixed.src}\n            onClick={() => {\n              navigate(picture.fields.url)\n            }}\n          />\n        ),\n      }\n    })\n  }\n\n  return (\n    <Container>\n      <h2>摄影作品</h2>\n      <PhotoAlbum>\n        <StyledMarquee\n          delay={1000}\n          duration={1000}\n          interval={5000}\n          items={convert(splitted[0])}\n        />\n        <StyledMarquee\n          delay={2000}\n          duration={1000}\n          interval={5000}\n          direction=\"down\"\n          items={convert(splitted[1])}\n        />\n        <StyledMarquee\n          delay={3000}\n          duration={1000}\n          interval={5000}\n          direction=\"down\"\n          items={convert(splitted[2])}\n        />\n        <StyledMarquee\n          delay={4000}\n          duration={1000}\n          interval={5000}\n          items={convert(splitted[3])}\n        />\n      </PhotoAlbum>\n    </Container>\n  )\n}\n\nexport default PhotoBox\n"],"sourceRoot":""}